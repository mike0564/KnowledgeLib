# CTF之隐写术破解

## 一、隐写术可以利用图片、音频、视频为载体将数据隐藏在其中，将数据隐写到图像中较为常见。

## 二、图像隐写术进行数据隐写分为以下几类：

1. 在图片右击-属性-详细信息中隐藏数据信息

2. 将数据类型进行改写（rar类型数据 将其改写成jpg格式）

3. 根据各种类型图像的固定格式，隐藏数据

   - 修改图像开始标志，改变其原有图像格式；

   - 在图像结束标志后加入数据；

   - 在图像数据中假如数据，不影响视觉效果情况下修改像素数据，加入信息。
4. 利用隐写算法将数据隐写到图像中而不影响图像（仅限于jpg图像），隐写算法常见有F5、Guess、JSteg和JPHide等

## 三、破解隐写术方法及步骤：

1. 查看图像-属性-详细信息是否包括隐藏内容

2. 利用WinHex打开图像，搜索CTF、ctf或flag看是否在打开数据中存在相关信息

3. 检查图像开始标志和结束标志是否正确，若不正确修改图像标志恢复图像，打开查看是否ctf或flag等信息（往往gif属于动图，需要分帧查看各帧图像组合所得数据 若不是直接的ctf或flag信息 需要考虑将其解码）

   - jpg图像开始标志：FF D8     结束标志：FF D9

   - gif图像开始标志：47 49 46 38 39 61   结束标志：01 01 00 3B

   - bmp图像开始标志：结束标志：

   - png图像开始标志：89 50 4E 47 0D 0A 1A 0A   结束标志：00 00 00 00 49 45 4E 44 AE 42 60 82

4. 将图像放置kali系统中，执行binwalk xxx.jpg 查看图像中是否是多个图像组合或者其中包含其他文件（若存在多幅图像组合，再执行foremost xxx.jpg会自动分离；若检测出其他文件修改其后缀即可，如.zip）

5. 使用StegSolve对图像进行分通道扫描，查看是否为LSB隐写

6. 在windows系统命令行下使用F5-steganography-master进行jpg图像是否为F5算法隐写

7. 在kali系统中使用outguess-master工具（需要安装），检测是否为guess算法隐写
